<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Generador de Contratos</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script> tailwind.config = { theme: { extend: {} } };</script>
  <style>
    :root{ --accent:#0ea5e9; --accent2:#22c55e; }
    .brand-gradient{ background: linear-gradient(90deg, var(--accent), var(--accent2)); }
    .input {
      background-color: #111827 !important;
      border: 1px solid #334155 !important;
      border-radius: 10px !important;
      padding: 0.7rem 0.9rem !important;
      width: 100% !important;
      color: #f8fafc !important;
      -webkit-text-fill-color: #f8fafc !important;
      font-weight: 600 !important;
      caret-color: #22d3ee !important;
      transition: all 0.15s ease-in-out;
    }
    .input::placeholder { color: #9ca3af; opacity: 1; }
    .input:focus { outline: none; border-color: #22d3ee !important; box-shadow: 0 0 0 2px #22d3ee55; background-color: #0f172a !important; }
    .btn { background: var(--accent); color:#001014; font-weight:700; border-radius:14px; padding:.7rem 1rem; text-align:center }
    .btn.alt { background:#334155; color:#e5e7eb }
    #loginOverlay{ position: fixed; inset: 0; background: rgba(2,6,23,.9); display:flex; align-items:center; justify-content:center; z-index:50; }
    .modal{ position:fixed; inset:0; background:rgba(2,6,23,.8); display:none; align-items:center; justify-content:center; z-index:60; }
    .badge{ font-size:.75rem; padding:.15rem .5rem; border-radius:999px; background:#0b4; color:#012; font-weight:700 }
    .badge.gray{ background:#374151; color:#e5e7eb }
  </style>
</head>
<body class="min-h-screen bg-slate-950 text-slate-100">
  <!-- LOGIN -->
  <div id="loginOverlay">
    <div class="w-[95%] max-w-md bg-slate-900/80 border border-slate-700 rounded-2xl p-6 backdrop-blur-md shadow">
      <h2 class="text-xl font-bold mb-4">Acceso</h2>
      <div class="space-y-3">
        <input id="loginUser" class="input" placeholder="Usuario" autocomplete="username" />
        <input id="loginPass" class="input" type="password" placeholder="Contraseña" autocomplete="current-password" />
        <button id="loginBtn" class="btn w-full">Ingresar</button>
        <p id="loginMsg" class="text-sm text-red-400 h-5"></p>
        <p class="text-xs opacity-70">*Nota: acceso de conveniencia (cliente). No usar para datos sensibles.</p>
      </div>
    </div>
  </div>

  <!-- HEADER -->
  <header class="brand-gradient p-5 shadow-xl">
    <div class="flex items-center justify-between gap-3">
      <h1 class="text-2xl font-bold">GENERADOR DE CONTRATOS</h1>
      <div class="flex items-center gap-2">
        <span id="whoami" class="text-sm px-2 py-1 rounded bg-black/20"></span>
        <button id="btnConfig" class="text-sm px-3 py-1 rounded bg-black/20 hover:bg-black/30 hidden">Configuración</button>
        <button id="logoutBtn" class="text-sm px-3 py-1 rounded bg-black/20 hover:bg-black/30">Salir</button>
      </div>
    </div>
  </header>

  <!-- MODAL CONFIG (solo admin) -->
  <div id="configModal" class="modal">
    <div class="w-[95%] max-w-2xl bg-slate-900/90 border border-slate-700 rounded-2xl p-6 backdrop-blur-md shadow relative">
      <button id="closeConfig" class="absolute right-3 top-3 px-2 py-1 bg-slate-800/70 rounded">✕</button>
      <h2 class="text-xl font-bold mb-4">Configuración (Admin)</h2>

      <!-- Crear usuario -->
      <div class="space-y-3">
        <h3 class="font-semibold">Crear nuevo usuario</h3>
        <div class="grid sm:grid-cols-3 gap-3">
          <input id="newUser" class="input" placeholder="Usuario" />
          <input id="newPass" class="input" placeholder="Contraseña" type="password" />
          <select id="newRole" class="input">
            <!-- Requisito: permitir marcarlo como standard (sin acceso a configuración) -->
            <option value="standard" selected>standard (solo uso)</option>
            <!-- Si quieres permitir crear administradores, descomenta la línea siguiente -->
            <!-- <option value="admin">admin (acceso total)</option> -->
          </select>
        </div>
        <div class="flex gap-3">
          <button id="btnCreateUser" class="btn">Crear usuario</button>
          <p id="userMsg" class="text-sm opacity-80"></p>
        </div>
      </div>

      <hr class="my-5 border-slate-700/70"/>

      <!-- Lista de usuarios (solo lectura mínima) -->
      <div class="space-y-2">
        <h3 class="font-semibold">Usuarios registrados</h3>
        <div id="usersList" class="text-sm space-y-1"></div>
        <p class="text-xs opacity-70">*Las contraseñas se almacenan localmente (solo demo). Para producción, usar servidor y hashing.</p>
      </div>
    </div>
  </div>

  <main class="max-w-6xl mx-auto p-6 space-y-8">
    <section class="grid md:grid-cols-3 gap-6">
      <div class="md:col-span-2 space-y-6">
        <!-- Datos -->
        <div class="bg-slate-900/60 rounded-2xl p-5 shadow">
          <h2 class="text-xl font-semibold mb-3">1) Datos del Representante Legal</h2>
          <div class="grid sm:grid-cols-2 gap-3">
            <input id="RAZON_SOCIAL" class="input" placeholder="RAZON SOCIAL" />
            <input id="RUC" class="input" placeholder="RUC" />
            <input id="DIRECCION" class="input" placeholder="DIRECCION" />
            <input id="NUMERO_DE_CALLE" class="input" placeholder="NUMERO DE CALLE" />
            <input id="DPTO_INT" class="input" placeholder="DPTO_INT" />
            <input id="URB" class="input" placeholder="URB" />
            <input id="DISTRITO" class="input" placeholder="DISTRITO" />
            <input id="CIUDAD" class="input" placeholder="CIUDAD" />
            <input id="APELLIDO_PATERNO" class="input" placeholder="APELLIDO PATERNO" />
            <input id="APELLIDO_MATERNO" class="input" placeholder="APELLIDO MATERNO" />
            <input id="NOMBRES" class="input" placeholder="NOMBRES" />
            <input id="CARGO" class="input" placeholder="CARGO" />
            <input id="DNI" class="input" placeholder="DNI" />
            <input id="TELEFONO" class="input" placeholder="TELEFONO" />
            <input id="CORREO" class="input col-span-2" placeholder="CORREO" />
          </div>
        </div>

        <!-- Contacto -->
        <div class="bg-slate-900/60 rounded-2xl p-5 shadow">
          <h2 class="text-xl font-semibold mb-3">2) Contacto de Instalación</h2>
          <div class="grid sm:grid-cols-2 gap-3">
            <input id="CONT_NOMB" class="input" placeholder="CONT_NOMB" />
            <input id="CONT_CARGO" class="input" placeholder="CONT_CARGO" />
            <input id="CONT_DNI" class="input" placeholder="CONT_DNI" />
            <input id="CONT_TELEF" class="input" placeholder="CONT_TELEF" />
            <input id="CONT_CORREO" class="input col-span-2" placeholder="CONT_CORREO" />
          </div>
        </div>

        <!-- Fecha -->
        <div class="bg-slate-900/60 rounded-2xl p-5 shadow">
          <h2 class="text-xl font-semibold mb-3">3) Fecha de Firma</h2>
          <div class="grid sm:grid-cols-3 gap-3">
            <input id="DIA" class="input" placeholder="DIA" />
            <input id="MES" class="input" placeholder="MES" />
            <input id="ANO" class="input" placeholder="AÑO" />
          </div>
        </div>

        <!-- Firmante -->
        <div class="bg-slate-900/60 rounded-2xl p-5 shadow">
          <h2 class="text-xl font-semibold mb-3">4) Firmante</h2>
          <div class="grid sm:grid-cols-2 gap-3">
            <input id="RL" class="input" placeholder="RL" />
            <input id="CARGO_FIRM" class="input" placeholder="CARGO (Firmante)" />
          </div>
        </div>

        <!-- Suplementarios -->
        <div class="bg-slate-900/60 rounded-2xl p-5 shadow">
          <h2 class="text-xl font-semibold mb-3">5) Servicios Suplementarios</h2>
          <div class="grid sm:grid-cols-3 gap-3">
            <input id="CANTIDAD" class="input" placeholder="CANTIDAD" inputmode="numeric" />
            <input id="SUB_TOTAL" class="input" placeholder="S/ 0.00" inputmode="decimal" />
            <input id="NOMB_PROMOCION" class="input" placeholder="NOMB_PROMOCION" />
          </div>
          <div class="mt-3 grid sm:grid-cols-2 gap-3">
            <input id="DIREC_INST" class="input" placeholder="DIREC_INST (Dirección de instalación)" />
            <input id="CONT_TOTAL" class="input" placeholder="S/ 0.00 (TOTAL opcional)" inputmode="decimal" />
          </div>
        </div>

        <!-- Tarifas y Servicios -->
        <div class="bg-slate-900/60 rounded-2xl p-5 shad

